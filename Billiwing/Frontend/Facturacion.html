<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Factura - Billiwing</title>
  <style>
    /* Variables por defecto */
    :root {
      --primary-color: #e72fd8;
      --secondary-color: #e9ecef;
      --font-family: 'Arial', sans-serif;
      --bg-color: #fff;
      --text-color: #222;
      --header-bg: var(--primary-color);
      --header-color: #fff;
      --box-shadow: 0 4px 15px rgba(231, 47, 216, 0.25);
      --border-color: #ccc;
    }
    body {
      margin: 0;
      font-family: var(--font-family);
      background: #f9f9f9;
      color: var(--text-color);
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .factura-container {
      max-width: 900px;
      width: 100%;
      margin: auto;
      background: var(--bg-color);
      padding: 20px 30px 30px 30px;
      border-radius: 10px;
      box-shadow: var(--box-shadow);
      transition: all 0.4s ease;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 3px solid var(--primary-color);
      margin-bottom: 15px;
      flex-wrap: wrap;
      gap: 10px;
    }
    .header h1 {
      color: var(--primary-color);
      margin: 0;
      font-weight: 700;
      font-size: 2rem;
      transition: color 0.4s ease;
    }
    .header .fecha {
      font-size: 1rem;
      font-weight: 600;
      color: #555;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .header .fecha input[type="date"] {
      padding: 6px 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    .header .color-picker {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      color: #555;
    }
    .header .color-picker input[type="color"] {
      width: 36px;
      height: 34px;
      border:none;
      cursor: pointer;
      padding: 0;
      background: none;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0 10px 0;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: inset 0 0 0 1px var(--border-color);
      transition: all 0.4s ease;
    }
    thead {
      background-color: var(--header-bg);
      color: var(--header-color);
      user-select: none;
      transition: background-color 0.4s ease, color 0.4s ease;
    }
    th, td {
      text-align: center;
      padding: 12px 10px;
      border-bottom: 1px solid var(--border-color);
      font-size: 1rem;
      transition: border-color 0.4s ease;
    }
    tbody tr:last-child td {
      border-bottom: none;
    }
    input[type="text"],
    input[type="number"],
    input[type="email"],
    input[type="date"],
    select,
    textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      font-size: 1rem;
      font-weight: 500;
      transition: border-color 0.3s ease;
    }
    input[type="text"]:focus,
    input[type="number"]:focus,
    select:focus,
    textarea:focus,
    input[type="date"]:focus,
    input[type="email"]:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 5px var(--primary-color);
    }
    .add-row-btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 6px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 10px;
      transition: background-color 0.3s ease;
    }
    .add-row-btn:hover {
      background-color: #d21cb3;
    }
    .submit-button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 1.2rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 30px;
      transition: background-color 0.3s ease;
      align-self: flex-start;
    }
    .submit-button:hover {
      background-color: #d21cb3;
    }
    .total-container {
      margin-top: 20px;
      text-align: right;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-color);
      user-select: none;
      transition: color 0.4s ease;
    }
    /* Form section wrapper and headings */
    fieldset {
      border: 2px solid var(--primary-color);
      border-radius: 10px;
      padding: 15px 25px 25px 25px;
      margin-bottom: 25px;
      background-color: var(--secondary-color);
      box-shadow: 0 4px 12px rgba(231, 47, 216, 0.2);
      transition: box-shadow 0.3s ease;
    }
    fieldset:hover, fieldset:focus-within {
      box-shadow: 0 6px 20px rgba(231, 47, 216, 0.4);
    }
    legend {
      font-weight: 700;
      font-size: 1.4rem;
      color: var(--primary-color);
      padding: 0 10px;
      user-select: none;
    }
    .form-sections {
      display: flex;
      flex-wrap: wrap;
      gap: 25px;
      margin-top: 10px;
      justify-content: flex-start;
    }
    .formulario {
      flex: 1 1 280px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .formulario label {
      font-weight: 600;
      margin-bottom: 5px;
      color: #444;
      transition: color 0.4s ease;
    }
    /* Special flex row for NIT and Name on the same line */
    .flex-row {
      display: flex;
      gap: 15px;
      align-items: center;
      flex-wrap: nowrap;
    }
    .flex-row .formulario {
      flex: 1 1 auto;
    }
    /* Payment method container with link */
    .payment-method-container {
      margin-top: 10px;
      font-size: 1rem;
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-width: 300px;
    }
    .payment-method-container label {
      font-weight: 700;
      color: var(--primary-color);
      cursor: pointer;
    }
    .payment-link {
      color: var(--primary-color);
      font-weight: 700;
      text-decoration: none;
      cursor: pointer;
      transition: color 0.3s ease;
      user-select: none;
      border: 2px solid var(--primary-color);
      border-radius: 6px;
      padding: 6px 10px;
      text-align: center;
      width: fit-content;
      display: inline-block;
    }
    .payment-link:hover,
    .payment-link:focus {
      color: #fff;
      background-color: var(--primary-color);
      outline: none;
    }
    /* Responsive adjustments */
    @media (max-width: 600px){
      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      .form-sections {
        flex-direction: column;
      }
      .formulario {
        width: 100%;
      }
      .flex-row {
        flex-direction: column;
      }
      .payment-method-container {
        max-width: 100%;
      }
      .design-options {
        justify-content: center;
      }
    }
    /* Diseño alternativo 1 - Dark Mode */
    .design-1 {
      --primary-color: #3498db;
      --secondary-color: #2c3e50;
      --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --bg-color: #1c2833;
      --text-color: #ecf0f1;
      --header-bg: #2980b9;
      --header-color: #ecf0f1;
      --box-shadow: 0 4px 15px rgba(41, 128, 185, 0.5);
      --border-color: #2980b9;
    }
    .design-1 input,
    .design-1 select,
    .design-1 textarea {
      background: #34495e;
      color: var(--text-color);
      border-color: #2980b9;
    }
    .design-1 input::placeholder {
      color: #bdc3c7;
    }
    /* Diseño alternativo 2 - Minimalista Claro */
    .design-2 {
      --primary-color: #27ae60;
      --secondary-color: #ecf0f1;
      --font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      --bg-color: #ffffff;
      --text-color: #2c3e50;
      --header-bg: #27ae60;
      --header-color: #ffffff;
      --box-shadow: 0 6px 20px rgba(39, 174, 96, 0.3);
      --border-color: #27ae60;
    }
    .design-2 input,
    .design-2 select,
    .design-2 textarea {
      background: #fafafa;
      color: var(--text-color);
      border-color: #27ae60;
    }
    .design-2 input::placeholder {
      color: #7f8c8d;
    }
    /* Diseño alternativo 3 - Vintage */
    .design-3 {
      --primary-color: #b5651d;
      --secondary-color: #f7f1e1;
      --font-family: 'Georgia', serif;
      --bg-color: #f7f1e1;
      --text-color: #5b3a00;
      --header-bg: #b5651d;
      --header-color: #f7f1e1;
      --box-shadow: 0 4px 15px rgba(181, 101, 29, 0.4);
      --border-color: #b5651d;
    }
    .design-3 input,
    .design-3 select,
    .design-3 textarea {
      background: #fff8e7;
      color: var(--text-color);
      border-color: #b5651d;
      font-style: italic;
    }
    .design-3 input::placeholder {
      color: #aa7c2a;
    }
    /* Diseño exclusivo 4 - Moderno Azul */
    .design-4 {
      --primary-color: #007acc;
      --secondary-color: #f0f4f8;
      --font-family: 'Roboto', 'Helvetica Neue', sans-serif;
      --bg-color: #ffffff;
      --text-color: #222;
      --header-bg: #005fa3;
      --header-color: #e0f0ff;
      --box-shadow: 0 6px 25px rgba(0,122,204,0.15);
      --border-color: #007acc;
    }
    .design-4 {
  --bg-color: #000;
  --text-color: #0ff;
  --primary-color: #00ffea;
  --header-bg: #001f26;
  --input-bg: #002c33;
  --border-color: #00ffea;
  font-family: 'Orbitron', sans-serif;
}
.design-4 body {
  background: var(--bg-color);
  color: var(--text-color);
  margin: 2rem 3rem;
  font-family: var(--font-family);
}
.design-4 header {
  background: var(--header-bg);
  text-align: center;
  padding: 1rem;
  font-size: 2.5rem;
  font-weight: 900;
  text-shadow: 0 0 15px var(--primary-color);
  border-radius: 10px 10px 0 0;
  letter-spacing: 2px;
}
.design-4 main {
  background: var(--input-bg);
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
  border-radius: 0 0 10px 10px;
  box-shadow: 0 0 20px var(--primary-color);
}
.design-4 label {
  font-weight: 700;
  margin-top: 1rem;
  color: var(--primary-color);
  text-shadow: 0 0 10px var(--primary-color);
  display: block;
}
.design-4 input, .design-4 select, .design-4 textarea {
  width: 100%;
  background: var(--bg-color);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  padding: 10px;
  font-size: 1.1rem;
  color: var(--text-color);
  text-shadow: 0 0 3px var(--primary-color);
}
.design-4 input::placeholder {
  color: #00fff0aa;
}
.design-4 table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1.5rem;
}
.design-4 th, .design-4 td {
  padding: 0.75rem;
  border: 1px solid var(--border-color);
  text-align: left;
}
.design-4 th {
  background: var(--primary-color);
  color: #000;
  font-weight: 900;
  text-shadow: none;
}
.design-4 button {
  margin-top: 1.5rem;
  background: var(--primary-color);
  color: #000;
  font-weight: 900;
  padding: 0.7rem 1.8rem;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  box-shadow: 0 0 25px var(--primary-color);
  transition: box-shadow 0.3s ease;
}
.design-4 button:hover {
  box-shadow: 0 0 40px #00ffe0;
}
.design-7 {
  --bg-color: #f0f4f8;
  --text-color: #34495e;
  --primary-color: #2980b9;
  --header-bg: #3498db;
  --input-bg: #ffffff;
  --border-color: #d1d9e6;
  font-family: 'Roboto', sans-serif;
}
.design-7 body {
  background: var(--bg-color);
  color: var(--text-color);
  margin: 3rem 4rem;
  font-family: var(--font-family);
}
.design-7 header {
  background: var(--header-bg);
  color: white;
  padding: 1.2rem;
  font-size: 2rem;
  font-weight: 700;
}
.design-6 {
  --bg-color: #121212;
  --text-color: #f0f;
  --primary-color: #0ff;
  --header-bg: #f0f;
  --input-bg: #222;
  --border-color: #f0f;
  font-family: 'Courier New', Courier, monospace;
}
.design-6 body {
  background: var(--bg-color);
  color: var(--text-color);
  margin: 3rem 2rem;
  font-family: var(--font-family);
}
.design-6 header {
  background: var(--header-bg);
  color: var(--bg-color);
  font-weight: 900;
  text-align: center;
  font-size: 2.5rem;
  padding: 1.5rem 0;
  border-radius: 15px 15px 0 0;
  text-shadow: 0 0 10px var(--text-color);
}
.design-6 main {
  background: var(--input-bg);
  max-width: 750px;
  margin: 0 auto;
  padding: 2rem;
  border-radius: 0 0 15px 15px;
  box-shadow: 0 0 15px var(--text-color);
}
.design-6 label {
  font-weight: 700;
  margin-top: 1.2rem;
  display: block;
}
.design-6 input, .design-6 select, .design-6 textarea {
  width: 100%;
  padding: 12px;
  font-size: 1rem;
  background: var(--bg-color);
  color: var(--text-color);
  border: 2px solid var(--border-color);
  border-radius: 8px;
  box-shadow: 0 0 8px var(--primary-color);
  font-family: var(--font-family);
}
.design-6 table {
  width: 100%;
  margin-top: 1.5rem;
  border-collapse: collapse;
}
.design-6 th, .design-6 td {
  padding: 0.8rem;
  border: 1px solid var(--border-color);
  text-align: left;
}
.design-6 th {
  background: var(--primary-color);
  color: var(--bg-color);
  font-weight: 900;
}
.design-6 button {
  margin-top: 1.5rem;
  background: var(--primary-color);
  color: var(--bg-color);
  font-weight: 900;
  padding: 0.8rem 2rem;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  box-shadow: 0 0 20px var(--text-color);
  transition: 0.3s ease;
}
.design-6 button:hover {
  box-shadow: 0 0 30px var(--primary-color);
  /* Diseño exclusivo 7- Moderno Azul */
}
    .design-4 input,
    .design-4 select,
    .design-4 textarea {
      background: #f7fbff;
      color: var(--text-color);
      border-color: #aad4ff;
      font-family: var(--font-family);
      font-weight: 400;
    }
    .design-4 input::placeholder {
      color: #9abed9;
    }
    .design-4 .header h1 {
      font-weight: 900;
      letter-spacing: 1.2px;
      text-transform: uppercase;
      color: var(--header-color);
    }
    .design-4 .header {
      border-bottom-color: var(--header-bg);
      background: var(--header-bg);
      padding: 15px 30px;
      border-radius: 10px 10px 0 0;
    }
    .design-4 table thead {
      background-color: var(--header-color);
      color: var(--header-bg);
      font-variant: small-caps;
    }
    .design-4 .add-row-btn, .design-4 .submit-button {
      background-color: var(--primary-color);
      border-radius: 50px;
      font-family: var(--font-family);
      font-weight: 700;
      box-shadow: 0 8px 15px rgba(0,122,204,0.3);
    }
    .design-4 .add-row-btn:hover, .design-4 .submit-button:hover {
      background-color: #005ea1;
      box-shadow: 0 10px 20px rgba(0,122,204,0.5);
    }
    .design-4 .total-container {
      color: var(--primary-color);
      font-family: var(--font-family);
      font-weight: 900;
      font-size: 1.6rem;
      letter-spacing: 1.1px;
    }
    /* Diseño exclusivo 5 - Elegante Oscuro */
    .design-5 {
      --primary-color: #b38859; /* dorado */
      --secondary-color: #2f2f2f;
      --font-family: 'Merriweather', serif;
      --bg-color: #1a1a1a;
      --text-color: #f8f3e6;
      --header-bg: #3e2f1c;
      --header-color: #b38859;
      --box-shadow: 0 6px 20px rgba(179, 136, 89, 0.4);
      --border-color: #b38859;
    }
    .design-5 input,
    .design-5 select,
    .design-5 textarea {
      background: #3b3428;
      color: var(--text-color);
      border-color: #b38859;
      font-family: var(--font-family);
      font-weight: 400;
      letter-spacing: 0.03em;
    }
    .design-5 input::placeholder {
      color: #d6c8aa;
      font-style: italic;
    }
    .design-5 .header h1 {
      font-family: var(--font-family);
      font-weight: 900;
      color: var(--primary-color);
      letter-spacing: 2px;
      font-size: 2.4rem;
      text-transform: uppercase;
      text-shadow: 0 0 4px #b38859aa;
    }
    .design-5 .header {
      border-bottom-color: var(--header-bg);
      background: var(--header-bg);
      padding: 20px 30px;
      border-radius: 10px 10px 0 0;
      box-shadow: inset 0 -3px 10px rgba(179,136,89,0.3);
    }
    .design-5 table thead {
      background-color: var(--header-bg);
      color: var(--header-color);
      font-weight: 700;
      border-bottom: 2px solid var(--primary-color);
      text-shadow: 0 0 2px #422d00;
    }
    .design-5 th, .design-5 td {
      border-color: #422d00;
    }
    .design-5 .add-row-btn, .design-5 .submit-button {
      background-color: var(--primary-color);
      border-radius: 8px;
      font-family: var(--font-family);
      font-weight: 700;
      box-shadow: 0 6px 15px rgba(179,136,89,0.6);
      transition: background-color 0.3s ease;
    }
    .design-5 .add-row-btn:hover, .design-5 .submit-button:hover {
      background-color: #9e6f30;
      box-shadow: 0 8px 20px rgba(179,136,89,0.9);
    }
    .design-5 .total-container {
      color: var(--primary-color);
      font-family: var(--font-family);
      font-weight: 900;
      font-size: 1.7rem;
      letter-spacing: 1.3px;
      text-shadow: 0 0 3px #b38859bb;
    }
    /* Diseño exclusivo 6 - Línea y Espacios */
    .design-6 {
      --primary-color: #222222;
      --secondary-color: #ffffff;
      --font-family: 'Open Sans', Arial, sans-serif;
      --bg-color: #fefefe;
      --text-color: #222222;
      --header-bg: transparent;
      --header-color: var(--primary-color);
      --box-shadow: none;
      --border-color: #444444;
    }
    .design-6 input,
    .design-6 select,
    .design-6 textarea {
      background: transparent;
      color: var(--text-color);
      border: none;
      border-bottom: 1.8px solid var(--border-color);
      border-radius: 0;
      font-family: var(--font-family);
      font-weight: 600;
      padding: 6px 0;
      margin-bottom: 10px;
    }
    .design-6 input::placeholder {
      color: #666666;
      font-weight: 400;
    }
    .design-6 .factura-container {
      box-shadow: none;
      padding: 30px 40px;
      background: var(--secondary-color);
    }
    .design-6 .header {
      border: none;
      padding-bottom: 0;
      margin-bottom: 20px;
      justify-content: flex-start;
      flex-wrap: nowrap;
      gap: 20px;
    }
    .design-6 .header h1 {
      font-weight: 900;
      font-size: 3rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--primary-color);
      margin: 0 10px 0 0;
    }
    .design-6 .header .fecha {
      font-weight: 600;
      font-size: 1rem;
      color: var(--primary-color);
      border-bottom: 1px solid var(--primary-color);
      padding-bottom: 2px;
      margin-left: auto;
      align-self: flex-end;
    }
    .design-6 table thead {
      background: none;
      color: var(--primary-color);
      border-bottom: 3px solid var(--primary-color);
      font-weight: 800;
      font-size: 1.2rem;
    }
    .design-6 th, .design-6 td {
      border-bottom: none;
      padding: 14px 12px;
    }
    .design-6 tbody tr {
      border-bottom: 1px solid var(--border-color);
      transition: background-color 0.2s ease;
    }
    .design-6 tbody tr:hover {
      background-color: #f4f4f4;
    }
    .design-6 .add-row-btn, .design-6 .submit-button {
      background-color: var(--primary-color);
      border-radius: 3px;
      font-family: var(--font-family);
      font-weight: 700;
      padding: 8px 16px;
      box-shadow: none;
      transition: background-color 0.2s ease;
    }
    .design-6 .add-row-btn:hover, .design-6 .submit-button:hover {
      background-color: #111111;
    }
    .design-6 .total-container {
      font-weight: 900;
      font-size: 1.8rem;
      color: var(--primary-color);
      margin-top: 40px;
      text-align: right;
      letter-spacing: 0.1em;
      user-select: all;
    }
    .design-6 .formulario label {
      color: var(--primary-color);
      font-weight: 700;
      font-size: 1rem;
      padding-bottom: 6px;
      border-bottom: 1px solid var(--primary-color);
      margin-bottom: 2px;
    }
.design-5 {
  --bg-color: #f7f1f0;
  --text-color: #6a4e42;
  --primary-color: #f28ab2;
  --header-bg: #f7d1d9;
  --input-bg: #fff0f5;
  --border-color: #f28ab2;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
.design-5 body {
  background: var(--bg-color);
  color: var(--text-color);
  margin: 3rem 4rem;
  font-family: var(--font-family);
}
.design-5 header {
  background: var(--header-bg);
  padding: 1rem;
  text-align: center;
  font-size: 2.2rem;
  font-weight: 700;
  border-radius: 15px 15px 0 0;
  color: var(--primary-color);
  box-shadow: 0 2px 8px #f28ab280;
}
.design-5 main {
  background: var(--input-bg);
  max-width: 750px;
  margin: 0 auto;
  padding: 2.5rem;
  border-radius: 0 0 15px 15px;
  box-shadow: 0 0 12px #f28ab240;
}
.design-5 label {
  margin-top: 1rem;
  font-weight: 600;
}
.design-5 input, .design-5 select, .design-5 textarea {
  width: 100%;
  padding: 10px;
  font-size: 1rem;
  border: 1px solid var(--border-color);
  border-radius: 6px;
  background: var(--bg-color);
  color: var(--text-color);
  box-shadow: inset 1px 1px 5px #f28ab230;
}
.design-5 table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1.5rem;
}
.design-5 th, .design-5 td {
  padding: 0.75rem;
  border-bottom: 1px solid var(--border-color);
}
.design-5 th {
  background: var(--primary-color);
  color: white;
  font-weight: 700;
  border-radius: 8px 8px 0 0;
}
.design-5 button {
  margin-top: 1.5rem;
  background: var(--primary-color);
  color: white;
  padding: 0.75rem 1.8rem;
  border-radius: 50px;
  border: none;
  font-weight: 700;
  cursor: pointer;
  transition: background 0.3s ease;
}
.design-5 button:hover {
  background: #d3668c;
}
.design-3 {
  --bg-color: #faf3e0;
  --text-color: #5d4037;
  --primary-color: #a1887f;
  --header-bg: #d7ccc8;
  --input-bg: #efebe9;
  --border-color: #bcaaa4;
  font-family: 'Georgia', serif;
}
.design-3 body {
  background: var(--bg-color);
  color: var(--text-color);
  margin: 2rem 5rem;
  font-family: var(--font-family);
}
.design-3 header {
  background: var(--header-bg);
  padding: 1.2rem;
  text-align: center;
  font-size: 2rem;
  font-weight: 700;
  border-radius: 10px 10px 0 0;
  box-shadow: 0 2px 10px #bcaaa4;
  color: var(--primary-color);
}
.design-3 main {
  background: var(--input-bg);
  max-width: 750px;
  margin: 0 auto;
  padding: 2rem;
  border-radius: 0 0 10px 10px;
  box-shadow: 0 0 12px #bcaaa4;
}
.design-3 label {
  margin-top: 1rem;
  font-weight: 700;
}
.design-3 input, .design-3 select, .design-3 textarea {
  width: 100%;
  padding: 10px;
  font-size: 1rem;
  border: 1px solid var(--border-color);
  border-radius: 5px;
  background: var(--bg-color);
  color: var(--text-color);
}
.design-3 table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1.5rem;
}
.design-3 th, .design-3 td {
  padding: 0.75rem;
  border: 1px solid var(--border-color);
}
.design-3 th {
  background: var(--primary-color);
  color: var(--bg-color);
  font-weight: 700;
}
.design-3 button {
  margin-top: 1.5rem;
  background: var(--primary-color);
  color: var(--bg-color);
  padding: 0.75rem 2rem;
  border-radius: 50px;
  border: none;
  font-weight: 700;
  cursor: pointer;
  transition: background 0.3s ease;
}
.design-3 button:hover {
  background: #8d6e63;
}
/* ========== DISEÑO 9+ FIGURAS GEOMÉTRICAS ========== */
.design-4 {
  --bg-color: #000;
  --text-color: #0ff;
  --primary-color: #00ffea;
  --header-bg: #001f26;
  --input-bg: #002c33;
  --border-color: #00ffea;
  font-family: 'Orbitron', sans-serif;
  position: relative;
  overflow: hidden;
}

/* ---------------- Header con triángulos ---------------- */
.design-4 header {
  background: var(--header-bg);
  text-align: center;
  padding: 1rem;
  font-size: 2.5rem;
  font-weight: 900;
  text-shadow: 0 0 15px var(--primary-color);
  border-radius: 10px 10px 0 0;
  letter-spacing: 2px;
  position: relative;
  z-index: 1; /* Para que las figuras queden detrás si es necesario */
}

/* Triángulo superior izquierdo */
.design-4 header::before {
  content: '';
  position: absolute;
  top: -40px;
  left: -40px;
  width: 0;
  height: 0;
  border-left: 80px solid transparent;
  border-bottom: 80px solid var(--primary-color);
  opacity: 0.4;
  transform: rotate(-15deg);
}

/* Triángulo superior derecho */
.design-4 header::after {
  content: '';
  position: absolute;
  top: -30px;
  right: -30px;
  width: 0;
  height: 0;
  border-right: 60px solid transparent;
  border-bottom: 60px solid var(--primary-color);
  opacity: 0.4;
  transform: rotate(15deg);
}

/* ----------------- Main con círculos y diagonales ----------------- */
.design-4 main {
  background: var(--input-bg);
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
  border-radius: 0 0 10px 10px;
  box-shadow: 0 0 20px var(--primary-color);
  position: relative;
  overflow: hidden;
}

/* Círculo grande semitransparente arriba a la izquierda */
.design-4 main::before {
  content: '';
  position: absolute;
  top: -120px;
  left: -100px;
  width: 240px;
  height: 240px;
  background: var(--primary-color);
  opacity: 0.1;
  border-radius: 50%;
  z-index: 0;
}

/* Diagonal inferior derecha */
.design-4 main::after {
  content: '';
  position: absolute;
  bottom: -100px;
  right: -200px;
  width: 400px;
  height: 400px;
  background: linear-gradient(
    135deg,
    transparent 50%,
    var(--primary-color) 50%
  );
  transform: rotate(45deg);
  opacity: 0.05;
  z-index: 0;
}

/* ---------------- Input, select y textarea ------------- */
.design-4 input,
.design-4 select,
.design-4 textarea {
  width: 100%;
  background: var(--bg-color);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  padding: 10px;
  font-size: 1.1rem;
  color: var(--text-color);
  text-shadow: 0 0 3px var(--primary-color);
  position: relative;
  z-index: 1;
}

/* Placeholder más tenue */
.design-4 input::placeholder,
.design-4 textarea::placeholder {
  color: #00fff0aa;
}

/* -------------- Tabla con cuadros y líneas diagonales -------------- */
.design-4 table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1.5rem;
  position: relative;
  z-index: 1;
}
.design-4 th,
.design-4 td {
  padding: 0.75rem;
  border: 1px solid var(--border-color);
  text-align: left;
  position: relative;
  z-index: 1;
}
/* Fondo de encabezados */
.design-4 th {
  background: var(--primary-color);
  color: #000;
  font-weight: 900;
  text-shadow: none;
}

/* Agregar líneas diagonales como patrón de fondo sobre la tabla */
.design-4 table::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    45deg,
    transparent 25%,
    var(--primary-color) 25%,
    var(--primary-color) 50%,
    transparent 50%,
    transparent 75%,
    var(--primary-color) 75%
  );
  background-size: 40px 40px;
  opacity: 0.03;
  pointer-events: none;
  z-index: 0;
}

/* ---------------- Botones con polígonos --------------- */
.design-4 button {
  margin-top: 1.5rem;
  background: var(--primary-color);
  color: #000;
  font-weight: 900;
  padding: 0.7rem 1.8rem;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  box-shadow: 0 0 25px var(--primary-color);
  transition: box-shadow 0.3s ease, transform 0.2s ease;
  position: relative;
  z-index: 1;
}

/* Polígono (hexágono) superpuesto en la esquina del botón */
.design-4 button::before {
  content: '';
  position: absolute;
  top: -10px;
  right: -10px;
  width: 0;
  height: 0;
  border-left: 20px solid transparent;
  border-right: 20px solid transparent;
  border-bottom: 35px solid var(--bg-color);
  transform: rotate(45deg);
  box-shadow: 0 0 5px var(--primary-color);
  z-index: 0;
}

.design-4 button:hover {
  box-shadow: 0 0 40px #00ffe0;
  transform: translateY(-2px);
}

    /* Opciones diseño */
    .design-options {
      max-width: 900px;
      margin: 20px auto 0 auto  ;
      display: flex;
      gap: 15px;
      justify-content: flex-start;
      flex-wrap: wrap;
      user-select: none;
    }
    .design-card {
      border: 2px solid #ddd;
      border-radius: 10px;
      width: 110px;
      height: 140px;
      cursor: pointer;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      flex-direction: column;
      padding: 10px;
      background: #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      position: relative;
    }
    .design-card:hover {
      border-color: var(--primary-color);
      box-shadow: 0 0 8px var(--primary-color);
    }
    .design-card.selected {
      border-color: var(--primary-color);
      box-shadow: 0 0 12px var(--primary-color);
    }
    .design-swatch {
      flex: 1;
      border-radius: 8px;
      margin-bottom: 8px;
      box-shadow: inset 0 0 0 1px #ccc;
      transition: background-color 0.3s ease;
    }
    .design1-swatch {
      background: linear-gradient(135deg, #3498db, #2980b9);
    }
    .design2-swatch {
      background: linear-gradient(135deg, #27ae60, #2ecc71);
    }
    .design3-swatch {
      background: linear-gradient(135deg, #b5651d, #aa651b);
    }
    .design4-swatch {
      background: linear-gradient(135deg, #007acc, #005fa3);
    }
    .design5-swatch {
      background: linear-gradient(135deg, #b38859, #3e2f1c);
    }
    .design6-swatch {
      background: linear-gradient(135deg, #222222, #fefefe);
    }
    .design-label {
      text-align: center;
      font-weight: 700;
      font-size: 0.9rem;
      color: #555;
      user-select: none;
    }
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      border: 0;
    }
  </style>
</head>
<body>

<div class="design-options" role="radiogroup" aria-label="Opciones de diseño de factura">
  <div class="design-card selected" tabindex="0" role="radio" aria-checked="true" data-design="default">
    <div class="design-swatch" style="background: linear-gradient(135deg, #e72fd8, #d51daf);"></div>
    <div class="design-label">Por Defecto</div>
  </div>
  <div class="design-card" tabindex="0" role="radio" aria-checked="false" data-design="design-1">
    <div class="design1-swatch design-swatch"></div>
    <div class="design-label">Oscuro</div>
  </div>
  <div class="design-card" tabindex="0" role="radio" aria-checked="false" data-design="design-2">
    <div class="design2-swatch design-swatch"></div>
    <div class="design-label">Minimalista</div>
  </div>
  <div class="design-card" tabindex="0" role="radio" aria-checked="false" data-design="design-3">
    <div class="design3-swatch design-swatch"></div>
    <div class="design-label">Vintage</div>
  </div>
  <div class="design-card" tabindex="0" role="radio" aria-checked="false" data-design="design-4">
    <div class="design4-swatch design-swatch"></div>
    <div class="design-label">Moderno Azul</div>
  </div>
  <div class="design-card" tabindex="0" role="radio" aria-checked="false" data-design="design-5">
    <div class="design5-swatch design-swatch"></div>
    <div class="design-label">Elegante Oscuro</div>
  </div>
  <div class="design-card" tabindex="0" role="radio" aria-checked="false" data-design="design-6">
    <div class="design6-swatch design-swatch"></div>
    <div class="design-label">Línea y Espacios</div>
  </div>
</div>

<div class="factura-container" id="facturaContainer" tabindex="-1">
  <div class="header">
    <h1>Factura</h1>
    <div class="fecha" style="flex-shrink:0;">
      <label for="fecha">Fecha:</label>
      <input type="date" id="fecha" name="fecha" required aria-required="true" aria-describedby="fecha-desc" />
      <div id="fecha-desc" class="sr-only">Seleccione la fecha de la factura</div>
    </div>
    <div class="color-picker" style="flex-shrink:0;">
      <label for="colorSelector">Color:</label>
      <input type="color" id="colorSelector" name="colorSelector" value="#e72fd8" aria-label="Selector de color principal de la factura" />
    </div>
  </div>

  <!-- Formulario principal de factura -->
  <form id="facturaForm" class="formulario" novalidate>
    <table>
      <thead>
        <tr>
          <th>Descripción</th>
          <th>Cantidad</th>
          <th>Precio unitario</th>
          <th>Total</th>
          <th>Acción</th>
        </tr>
      </thead>
      <tbody id="itemsBody">
        <tr class="item-row">
          <td><input type="text" name="descripcion[]" placeholder="Descripción" required aria-required="true" /></td>
          <td><input type="number" name="cantidad[]" min="1" value="1" required aria-required="true" /></td>
          <td><input type="number" name="precio[]" min="0" step="0.01" value="0.00" required aria-required="true" /></td>
          <td><input type="text" name="total[]" value="0.00" disabled aria-disabled="true" /></td>
          <td><button type="button" class="remove-row-btn" title="Eliminar fila" aria-label="Eliminar fila">&times;</button></td>
        </tr>
      </tbody>
    </table>
    <button type="button" class="add-row-btn" aria-label="Agregar fila">Agregar ítem</button>

    <div class="total-container" aria-live="polite" aria-atomic="true">
      Total General: $<span id="totalGeneral">0.00</span>
    </div>

    <!-- Company section -->
    <fieldset aria-labelledby="legend-empresa">
      <legend id="legend-empresa">Datos de la Empresa</legend>
      <div class="flex-row">
        <div class="formulario">
          <label for="empresa-nit">NIT Empresa:</label>
          <input
            type="text"
            id="empresa-nit"
            name="empresa-nit"
            placeholder="Número de identificación fiscal"
            required
            aria-required="true"
            autocomplete="off"
          />
        </div>
        <div class="formulario">
          <label for="empresa">Nombre de la Empresa:</label>
          <input
            type="text"
            id="empresa"
            name="empresa"
            placeholder="Nombre de la empresa"
            required
            aria-required="true"
            autocomplete="organization"
          />
        </div>
      </div>
      <div class="formulario">
        <label for="empresa-email">Email de la Empresa:</label>
        <input
          type="email"
          id="empresa-email"
          name="empresa-email"
          placeholder="empresa@ejemplo.com"
          required
          aria-required="true"
          autocomplete="email"
        />
      </div>
      <div class="formulario">
        <label for="empresa-direccion">Dirección de la Empresa:</label>
        <textarea
          id="empresa-direccion"
          name="empresa-direccion"
          rows="3"
          placeholder="Dirección de la empresa"
          required
          aria-required="true"
        ></textarea>
      </div>
    </fieldset>

    <!-- Client section -->
    <fieldset aria-labelledby="legend-cliente">
      <legend id="legend-cliente">Datos del Cliente</legend>
      <div class="flex-row">
        <div class="formulario">
          <label for="cliente-nit">NIT Cliente:</label>
          <input
            type="text"
            id="cliente-nit"
            name="cliente-nit"
            placeholder="Número de identificación fiscal"
            required
            aria-required="true"
            autocomplete="off"
          />
        </div>
        <div class="formulario">
          <label for="nombre">Nombre del Cliente:</label>
          <input
            type="text"
            id="nombre"
            name="nombre"
            placeholder="Nombre completo"
            required
            aria-required="true"
            autocomplete="name"
          />
        </div>
      </div>
      <div class="formulario">
        <label for="email">Email del Cliente:</label>
        <input
          type="email"
          id="email"
          name="email"
          placeholder="correo@ejemplo.com"
          required
          aria-required="true"
          autocomplete="email"
        />
      </div>
      <div class="formulario">
        <label for="direccion">Dirección:</label>
        <textarea
          id="direccion"
          name="direccion"
          rows="3"
          placeholder="Dirección del cliente"
          required
          aria-required="true"
        ></textarea>
      </div>
    </fieldset>

    <!-- Payment method with portal links -->
    <fieldset aria-labelledby="legend-pago" class="payment-method-container">
      <legend id="legend-pago">Método de Pago</legend>
      <label for="metodo-pago">Seleccione método de pago:</label>
      <select id="metodo-pago" name="metodo-pago" required aria-required="true" aria-describedby="payment-desc">
        <option value="">Seleccione...</option>
        <option value="tarjeta">Tarjeta de Crédito</option>
        <option value="efectivo">Efectivo</option>
        <option value="transferencia">Transferencia Bancaria</option>
      </select>
      <div id="payment-desc" class="sr-only">Selecciona un método de pago para ver el enlace al portal correspondiente</div>
      <a href="#" target="_blank" rel="noopener" class="payment-link" id="payment-link" style="display:none;">Ir al portal de pago</a>
    </fieldset>

    <button type="submit" class="submit-button" aria-label="Enviar factura">
      Generar y Enviar Factura
    </button>
  </form>
</div>

<!-- External libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.emailjs.com/dist/email.min.js"></script>

<script>
  // Initialize EmailJS - replace 'YOUR_USER_ID' with your user ID from EmailJS
  (function () {
    emailjs.init('YOUR_USER_ID');
  })();

  document.addEventListener('DOMContentLoaded', () => {
    const itemsBody = document.getElementById('itemsBody');
    const addRowBtn = document.querySelector('.add-row-btn');
    const totalGeneralSpan = document.getElementById('totalGeneral');
    const colorSelector = document.getElementById('colorSelector');
    const facturaContainer = document.getElementById('facturaContainer');
    const designCards = document.querySelectorAll('.design-card');
    const form = document.getElementById('facturaForm');
    const paymentMethodSelect = document.getElementById('metodo-pago');
    const paymentLink = document.getElementById('payment-link');
    let customColor = colorSelector.value;

    function calcularTotales() {
      let totalGeneral = 0;
      const filas = itemsBody.querySelectorAll('tr.item-row');
      filas.forEach((fila) => {
        const cantidadInput = fila.querySelector('input[name="cantidad[]"]');
        const precioInput = fila.querySelector('input[name="precio[]"]');
        const totalInput = fila.querySelector('input[name="total[]"]');

        let cantidad = parseFloat(cantidadInput.value) || 0;
        let precio = parseFloat(precioInput.value) || 0;
        let total = cantidad * precio;
        totalInput.value = total.toFixed(2);

        totalGeneral += total;
      });
      totalGeneralSpan.textContent = totalGeneral.toFixed(2);
    }

    function agregarEventosFila(fila) {
      const cantidadInput = fila.querySelector('input[name="cantidad[]"]');
      const precioInput = fila.querySelector('input[name="precio[]"]');
      const removeBtn = fila.querySelector('.remove-row-btn');

      cantidadInput.addEventListener('input', calcularTotales);
      precioInput.addEventListener('input', calcularTotales);

      removeBtn.addEventListener('click', () => {
        fila.remove();
        calcularTotales();
      });
    }

    agregarEventosFila(itemsBody.querySelector('tr.item-row'));
    calcularTotales();

    addRowBtn.addEventListener('click', () => {
      const nuevaFila = document.createElement('tr');
      nuevaFila.classList.add('item-row');
      nuevaFila.innerHTML = `
        <td><input type="text" name="descripcion[]" placeholder="Descripción" required aria-required="true" /></td>
        <td><input type="number" name="cantidad[]" min="1" value="1" required aria-required="true" /></td>
        <td><input type="number" name="precio[]" min="0" step="0.01" value="0.00" required aria-required="true" /></td>
        <td><input type="text" name="total[]" value="0.00" disabled aria-disabled="true" /></td>
        <td><button type="button" class="remove-row-btn" title="Eliminar fila" aria-label="Eliminar fila">&times;</button></td>
      `;
      itemsBody.appendChild(nuevaFila);
      agregarEventosFila(nuevaFila);
      calcularTotales();
    });

    function actualizarColorPrimario(nuevoColor) {
      customColor = nuevoColor;
      if (
        !facturaContainer.classList.contains('design-1') &&
        !facturaContainer.classList.contains('design-2') &&
        !facturaContainer.classList.contains('design-3') &&
        !facturaContainer.classList.contains('design-4') &&
        !facturaContainer.classList.contains('design-5') &&
        !facturaContainer.classList.contains('design-6')
      ) {
        document.documentElement.style.setProperty('--primary-color', nuevoColor);
      }
    }
    colorSelector.addEventListener('input', (e) => {
      actualizarColorPrimario(e.target.value);
    });

    function seleccionarDiseño(nombreDiseño) {
      facturaContainer.classList.remove(
        'design-1',
        'design-2',
        'design-3',
        'design-4',
        'design-5',
        'design-6'
      );
      if (nombreDiseño !== 'default') {
        facturaContainer.classList.add(nombreDiseño);
        switch (nombreDiseño) {
          case 'design-1':
            document.documentElement.style.setProperty('--primary-color', '#3498db');
            break;
          case 'design-2':
            document.documentElement.style.setProperty('--primary-color', '#27ae60');
            break;
          case 'design-3':
            document.documentElement.style.setProperty('--primary-color', '#b5651d');
            break;
          case 'design-4':
            document.documentElement.style.setProperty('--primary-color', '#007acc');
            break;
          case 'design-5':
            document.documentElement.style.setProperty('--primary-color', '#b38859');
            break;
          case 'design-6':
            document.documentElement.style.setProperty('--primary-color', '#222222');
            break;
          default:
            document.documentElement.style.setProperty('--primary-color', customColor);
            break;
        }
      } else {
        document.documentElement.style.setProperty('--primary-color', customColor);
      }
      designCards.forEach((card) => {
        const isSelected = card.getAttribute('data-design') === nombreDiseño;
        card.classList.toggle('selected', isSelected);
        card.setAttribute('aria-checked', isSelected ? 'true' : 'false');
      });
    }
    designCards.forEach((card) => {
      card.addEventListener('click', () => {
        seleccionarDiseño(card.getAttribute('data-design'));
      });
      card.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          seleccionarDiseño(card.getAttribute('data-design'));
        }
      });
    });
    seleccionarDiseño('default');

    // Update payment portal link based on method selected
    function actualizarEnlacePago(){
      const metodo = paymentMethodSelect.value;
      let url = '';
      let texto = '';

      switch (metodo) {
        case 'tarjeta':
          url = 'https://www.paypal.com/signin'; // sample credit card payment portal
          texto = 'Realizar pago con Tarjeta de Crédito (PayPal)';
          break;
        case 'efectivo':
          url = '';
          texto = 'Pago en efectivo (sin enlace)';
          break;
        case 'transferencia':
          url = 'https://www.banco.com/transferencias'; // placeholder bank transfer portal
          texto = 'Realizar Transferencia Bancaria';
          break;
        default:
          url = '';
          texto = '';
          break;
      }

      if(url){
        paymentLink.href = url;
        paymentLink.textContent = texto;
        paymentLink.style.display = 'inline-block';
        paymentLink.setAttribute('tabindex', '0');
      } else {
        paymentLink.style.display = 'none';
        paymentLink.removeAttribute('tabindex');
      }
    }
    paymentMethodSelect.addEventListener('change', actualizarEnlacePago);
    // Initialize on load
    actualizarEnlacePago();

    // Generate PDF invoice using jsPDF
    function generarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const fecha = form.fecha.value;
      const empresa = form.empresa.value.trim();
      const empresaNit = form['empresa-nit'].value.trim();
      const empresaEmail = form['empresa-email'].value.trim();
      const empresaDireccion = form['empresa-direccion'].value.trim();
      const nombre = form.nombre.value.trim();
      const clienteNit = form['cliente-nit'].value.trim();
      const email = form.email.value.trim();
      const direccion = form.direccion.value.trim();
      const metodoPago = form['metodo-pago'].value;

      // Header
      doc.setFontSize(18);
      doc.setTextColor(40, 62, 81);
      doc.text(empresa || "Nombre Empresa", 105, 15, null, null, "center");

      doc.setFontSize(12);
      doc.setTextColor(90);

      doc.text(`NIT: ${empresaNit || '-'}`, 105, 22, null, null, "center");
      doc.text(`Email: ${empresaEmail || '-'}`, 105, 28, null, null, "center");
      doc.text(`Dirección: ${empresaDireccion || '-'}`, 105, 34, null, null, "center");

      doc.setLineWidth(0.5);
      doc.line(10, 40, 200, 40);

      let y = 48;

      // Invoice info
      doc.setFontSize(14);
      doc.setTextColor(33);
      doc.text("Factura", 14, y);
      doc.setFontSize(11);
      y += 8;
      doc.text(`Fecha: ${fecha || '-'}`, 14, y);
      y += 6;
      doc.text(`Cliente: ${nombre || '-'}`, 14, y);
      y += 6;
      doc.text(`NIT Cliente: ${clienteNit || '-'}`, 14, y);
      y += 6;
      doc.text(`Email cliente: ${email || '-'}`, 14, y);
      y += 6;
      doc.text(`Dirección cliente: ${direccion || '-'}`, 14, y);
      y += 6;
      doc.text(`Método de pago: ${metodoPago || '-'}`, 14, y);

      y += 10;
      doc.line(10, y, 200, y);
      y += 6;

      // Table header
      doc.setFontSize(12);
      doc.setFillColor(231, 47, 216);
      doc.setTextColor(255, 255, 255);
      doc.rect(10, y - 5, 180, 10, 'F');
      doc.text("Descripción", 15, y);
      doc.text("Cantidad", 85, y);
      doc.text("P. unitario", 120, y);
      doc.text("Total", 165, y);

      y += 6;
      doc.setTextColor(0);
      doc.setFontSize(11);

      // Items rows
      const filas = itemsBody.querySelectorAll('tr.item-row');

      filas.forEach((fila, i) => {
        if (y > 270) {
          doc.addPage();
          y = 20;
        }
        const desc = fila.querySelector('input[name="descripcion[]"]').value.trim();
        const cant = fila.querySelector('input[name="cantidad[]"]').value;
        const prec = fila.querySelector('input[name="precio[]"]').value;
        const tot = parseFloat(cant) * parseFloat(prec);

        doc.text(desc || "-", 15, y);
        doc.text(cant || "0", 90, y, null, null, "right");
        doc.text(`$${parseFloat(prec).toFixed(2) || "0.00"}`, 130, y, null, null, "right");
        doc.text(`$${tot ? tot.toFixed(2) : "0.00"}`, 180, y, null, null, "right");
        y += 7;
      });

      y += 10;
      doc.setFontSize(14);
      doc.text(`Total General: $${totalGeneralSpan.textContent}`, 165, y, null, null, "right");

      // Save PDF
      doc.save(`Factura_${nombre.replace(/\s+/g, '_') || 'cliente'}.pdf`);
    }

    // Send invoice email via EmailJS
    function enviarFacturaPorEmail() {
      const fecha = form.fecha.value;
      const empresa = form.empresa.value.trim();
      const empresaNit = form['empresa-nit'].value.trim();
      const empresaEmail = form['empresa-email'].value.trim();
      const empresaDireccion = form['empresa-direccion'].value.trim();
      const nombre = form.nombre.value.trim();
      const clienteNit = form['cliente-nit'].value.trim();
      const email = form.email.value.trim();
      const direccion = form.direccion.value.trim();
      const metodoPago = form['metodo-pago'].value;

      let items = [];
      const filas = itemsBody.querySelectorAll('tr.item-row');
      filas.forEach((fila) => {
        const desc = fila.querySelector('input[name="descripcion[]"]').value.trim();
        const cant = fila.querySelector('input[name="cantidad[]"]').value;
        const prec = fila.querySelector('input[name="precio[]"]').value;
        const tot = fila.querySelector('input[name="total[]"]').value;
        if (desc && cant && prec) {
          items.push({ descripcion: desc, cantidad: cant, precio: prec, total: tot });
        }
      });

      let mensaje = `Factura para: ${nombre}\nNIT Cliente: ${clienteNit}\nFecha: ${fecha}\nEmail: ${email}\nDirección: ${direccion}\nMétodo de pago: ${metodoPago}\n\nItems:\n`;
      items.forEach((item, i) => {
        mensaje += `${i + 1}. ${item.descripcion} - Cantidad: ${item.cantidad}, Precio: $${item.precio}, Total: $${item.total}\n`;
      });
      mensaje += `\nTotal General: $${totalGeneralSpan.textContent}\n\n`;
      mensaje += `Empresa:\n${empresa}\nNIT Empresa: ${empresaNit}\nEmail empresa: ${empresaEmail}\nDirección empresa: ${empresaDireccion}`;

      emailjs
        .send('YOUR_SERVICE_ID', 'YOUR_TEMPLATE_ID', {
          to_email: email,
          message: mensaje,
          from_name: empresa,
          reply_to: empresaEmail,
        })
        .then(
          function (response) {
            alert('Factura enviada con éxito al email del cliente.');
          },
          function (error) {
            alert('Error al enviar el email: ' + JSON.stringify(error));
          }
        );
    }

    // Form submission handler: validate, generate PDF and send email
    form.addEventListener('submit', (e) => {
      e.preventDefault();

      if (!form.checkValidity()) {
        alert('Por favor, complete todos los campos requeridos correctamente.');
        return;
      }

      calcularTotales();

      generarPDF();

      enviarFacturaPorEmail();
    });
  });
</script>
</body>
</html>





